<?php
class solrecovery
{
	var $class = "solrecovery";
	var $pieces = 1;
	var $min_cloak = 0; // Cloak value of each artifact piece
	var $max_cloak = 0; // Maximum Cloak value of each artifact piece
	var $scoremax = 100000; // Any player with a score over this value will not be able to see the artifact. Set to 0 for everyone to see.
	var $scoremax_text = "100,000"; // Any player with a score over this value will not be able to see the artifact. Set to 0 for everyone to see.
	var $schedinfo;
	var $delayedprocess = 1; // If the completed artifact can be processed at a different time after completion.  Player can execute the artifact from the Artifact List selection.  Set to 1 for delayed processing.
	var $maximum_in_galaxy = 40; // The maximum number of artifacts of this class in the galaxy.  Multiply this number by $pieces to get the total number of pieces in the galaxy.

	function solrecovery()
	{
		global $langdir;
		switch ($langdir)
		{
			case "estonian":
				$this->classname = "Sol taastamise Tehis";
				$this->description = "See Tehis loob Wormhole mis tahes sektoris (realspace või SG), et Sol ja transpordi sa seal koheselt. Kui sinu skoor jõuab " . $this->scoremax_text . " te ei näe või pikap see artefaktist. Kui teil on kaasas üks kaotate seda. On kokku " . $this->pieces . " tükki, et tuleb leida. Kui kõik nupud on leitud saate luua Wormhole kaudu Tehis nimekiri käsk. Tehis tükki on salvestatud laeva. Kui teie laev on hävitatud Ründaja võib leida mõningaid nuppe. Iga tükki ei ole püütud ründaja on juhuslikult jagatud ümber galaktika.";
				$this->success = "Sa ei leidnud kõiki " . $this->pieces . " tükid " . $this->classname . ". Võite kasutada seda Artefakti igal ajal Tehis nimekiri leheküljel.";
				$this->incomplete = "Olete leidnud [pieces] tükki " . $this->classname . ". Peate [left] veel [piece] lõpule artefaktist.";
				$this->singular = "tk";
				$this->plural = "tk";
				$this->upgrade = "Upgrade varjatud";
			break;

			case "french":
				$this->classname = "Sol de récupération d&#39;artefact";
				$this->description = "Cet artefact va créer un trou de ver de tous les secteurs (REALSPACE ou SG) à Sol et le transport de vous y instantanément. Une fois votre score atteint " . $this->scoremax_text . " vous ne serez pas en mesure de voir ou de ramassage cet artefact. Si vous transportez celle que vous allez perdre. Il ya un total de " . $this->pieces . " pièces qui doivent être trouvés. Une fois toutes les pièces sont trouvés, vous pouvez créer le trou de ver à travers la commande Liste Artefact. Les morceaux d&#39;artefact seront stockées sur votre bateau. Si votre vaisseau est détruit à l&#39;attaquant mai trouver certaines des pièces. Les morceaux non exploités par l&#39;attaquant seront distribuées au hasard autour de la galaxie.";
				$this->success = "Vous avez trouvé toutes les " . $this->pieces . " pièces de la " . $this->classname . ". Vous pouvez utiliser cet objet à tout moment sur la page Liste Artefact.";
				$this->incomplete = "Vous avez trouvé [pieces] pièces de la " . $this->classname . ". Vous devez vous [left] plus [piece] pour terminer l&#39;artefact.";
				$this->singular = "morceau";
				$this->plural = "pièces";
				$this->upgrade = "Upgrade Cloak";
			break;

			case "german":
				$this->classname = "Sol Recovery Artefakt";
				$this->description = "Dieses Artefakt wird ein Wurmloch von jedem Sektor (realspace oder SG) bis Sol erstellen und transportieren Sie es sofort. Nachdem Sie Ihre Gäste erreicht " . $this->scoremax_text . " Sie werden nicht in der Lage sein zu sehen, oder dieses Artefakt Pickup. Wenn Sie sich tragen Sie ein, wird es verlieren. Es gibt insgesamt " . $this->pieces . " Stücke, die gefunden werden müssen. Wenn alle Teile gefunden sind, können Sie das Wurmloch durch das Artefakt Liste Befehl zu erstellen. The Artifact Stücke werden auf dem Schiff gelagert werden. Wenn Ihr Schiff zerstört wird der Angreifer einige der Stücke zu finden. Jedes Stück vom Angreifer nicht erfasst werden nach dem Zufallsprinzip auf der ganzen Galaxie verteilt werden.";
				$this->success = "Sie haben festgestellt, alle " . $this->pieces . " Teile des " . $this->classname . ". Sie können dieses Artefakt Nutzung jederzeit aus der Liste Artefakt Seite.";
				$this->incomplete = "Sie haben sie gefunden [pieces] Teile des " . $this->classname . ". Sie müssen [left] mehr [piece], um das Artefakt abzuschließen.";
				$this->singular = "Stück";
				$this->plural = "Stück";
				$this->upgrade = "Upgrade Cloak";
			break;

			case "italian":
				$this->classname = "Sol Recovery Artifact";
				$this->description = "Artefatto questo creerà un Wormhole da qualsiasi settore (mondo fisico o SG) a Sol e trasporti lì all&#39;istante. Una volta che il tuo punteggio raggiunge " . $this->scoremax_text . " non sarà in grado di vedere o pick-up questo artefatto. Se si stanno realizzando quello che la perderà. Ci sono un totale di " . $this->pieces . " pezzi che devono essere trovati. Una volta che tutti i pezzi sono trovati, è possibile creare il Wormhole tramite il comando Artefatto List. I pezzi Artifact verranno memorizzati sulla tua nave. Se la tua nave è distrutta l&#39;utente malintenzionato potrebbe trovare alcuni dei pezzi. I pezzi non catturato da un aggressore saranno distribuiti a caso intorno alla galassia.";
				$this->success = "Hai trovato tutti " . $this->pieces . " pezzi del " . $this->classname . ". È possibile utilizzare questo artefatto in qualsiasi momento dalla pagina Artefatto List.";
				$this->incomplete = "Hai trovato [pieces] pezzi del " . $this->classname . ". Avete bisogno di [left] continua [piece] per completare l&#39;artefatto.";
				$this->singular = "pezzo";
				$this->plural = "pezzi";
				$this->upgrade = "Upgrade Cloak";
			break;

			case "spanish":
				$this->classname = "Sol de recuperación Artefacto";
				$this->description = "Este artefacto creará un agujero de gusano, de cualquier sector (espacio real o SG) de Sol y de transporte que hay al instante. Una vez que el marcador llega a " . $this->scoremax_text . " usted no será capaz de ver o de recolección de este artefacto. Si está llevando a que usted perderá. Hay un total de " . $this->pieces . " piezas que necesitan ser encontrados. Una vez que todas las piezas se encuentran se puede crear a través del agujero de gusano el comando Lista Artefacto. Las piezas artefacto se almacenará en su barco. Si el barco es destruido el atacante puede encontrar algunas de las piezas. Cualquier pieza no capturados por el atacante se distribuyen al azar alrededor de la galaxia.";
				$this->success = "Se han encontrado todos los " . $this->pieces . " piezas de la " . $this->classname . ". Usted puede usar este artefacto en cualquier momento desde la página Lista de Artefacto.";
				$this->incomplete = "Se han encontrado [pieces] piezas de la " . $this->classname . ". Usted necesita [left] más [piece] para completar el artefacto.";
				$this->singular = "pieza";
				$this->plural = "piezas";
				$this->upgrade = "Capa de actualización";
			break;

			case "albanian":
				$this->classname = "Sol Recovery Objekti";
				$this->description = "Kjo Objekti i do të krijojë një Wormhole nga çdo sektori (realspace ose SG) në Sol dhe transportit ju atje menjëherë. Pasi Rezultati juaj arrin " . $this->scoremax_text . " ju nuk do të jetë në gjendje për të parë ose përmirësim këtë Objekti. Qoftë se keni me vete një nga ju do të humbni atë. Ka një numër të " . $this->pieces . " pjesë që duhet të gjendet. Pasi të gjitha këngët janë gjetur ju mund të krijoni Wormhole përmes komandës Lista Objekti. Objekti do të jetë pjesë ruhet në anije tuaj. Nëse anija juaj është shkatërruar sulmues mund të gjeni disa nga copa. Çdo copë nuk kapur nga sulmuesit do të shpërndahen rreth rastësisht galaktikë.";
				$this->success = " " . $this->pieces . " copë " . $this->classname . ". Ju mund të përdorni këtë Objekti në çdo kohë nga faqe Lista Objekti.";
				$this->incomplete = "Ju keni gjetur [pieces] copë " . $this->classname . ". Ju duhet [left] më [piece] për të përfunduar Objekti.";
				$this->singular = "copë";
				$this->plural = "copë";
				$this->upgrade = "Upgrade mantel";
			break;

			case "catalan":
				$this->classname = "Sol de recuperació Artefacte";
				$this->description = "Aquest artefacte crearà un forat de cuc, de qualsevol sector (espai real o SG) de Sol i de transport que hi ha a l&#39;instant. Una vegada que el marcador arriba a " . $this->scoremax_text . " vostè no serà capaç de veure o de recollida d&#39;aquest artefacte. Si està duent a que vostè perdrà. Hi ha un total de " . $this->pieces . " peces que necessiten ser trobats. Un cop que totes les peces es pot crear a través del forat de cuc la comanda Llista Artefacte. Les peces artefacte quedarà emmagatzemat al vaixell. Si el vaixell és destruït l&#39;atacant pot trobar algunes de les peces. Qualsevol peça no capturats per l&#39;atacant es distribueixen a l&#39;atzar al voltant de la galàxia.";
				$this->success = "S&#39;han trobat tots els " . $this->pieces . " peces de la " . $this->classname . ". Vostè pot usar aquest artefacte en qualsevol moment des de la pàgina Llista de Artefacte.";
				$this->incomplete = "S&#39;han trobat [pieces] peces de la " . $this->classname . ". Vostè necessita [left] més [piece] per completar l&#39;artefacte.";
				$this->singular = "peça";
				$this->plural = "peces";
				$this->upgrade = "Capa d&#39;actualització";
			break;

			case "danish":
				$this->classname = "Sol Recovery Artifact";
				$this->description = "Dette Artifact vil skabe et ormehul fra alle sektorer (realspace eller SG) til Sol og transport dig der straks. Når din score når " . $this->scoremax_text . " vil du ikke kunne se eller pickup denne artefakt. Hvis du medbringer en du vil miste det. Der er i alt " . $this->pieces . " stykker, der skal findes. Når alle brikker er fundet kan du oprette Ormehul gennem Artifact List kommando. Den Artifact stykker vil blive gemt på dit skib. Hvis dit skib er ødelagt hacker kan finde nogle af brikkerne. Nogen stykker, ikke opfanges af angriberen vil være tilfældigt fordelt over hele galaksen.";
				$this->success = "Du har fundet alle " . $this->pieces . " stykker af " . $this->classname . ". Du kan bruge denne genstand som helst fra Artifact List side.";
				$this->incomplete = "Du har fundet [pieces] stykker af " . $this->classname . ". Du har brug for [left] mere [piece] for at afslutte artefakt.";
				$this->singular = "brik";
				$this->plural = "stykker";
				$this->upgrade = "Upgrade Cloak";
			break;

			case "dutch":
				$this->classname = "Sol Recovery Artifact";
				$this->description = "Artefact Dit zal leiden tot een Wormhole uit alle sectoren (realspace of SG) naar Sol en daar vervoer u direct. Zodra uw score bereikt " . $this->scoremax_text . " u zult niet in staat zijn om te zien of dit artefact pickup. Als je bij je hebt die je zal het verliezen. Er zijn in totaal " . $this->pieces . " stukken die moeten worden gevonden. Zodra alle stukken zijn te vinden kunt u het wormgat te creëren door het Artefact opdracht Lijst. De Artefact stukken zal worden opgeslagen op uw schip. Als uw schip wordt vernietigd de aanvaller kan u enkele van de stukken. Elke stukken niet gevangen genomen door de aanvaller zal willekeurig worden verdeeld over de hele melkweg.";
				$this->success = "U hebt al gevonden " . $this->pieces . " stukken van " . $this->classname . ". U kunt deze artefact op elk moment van de Artefact Lijst pagina.";
				$this->incomplete = "U hebt gevonden [pieces] stukken van de " . $this->classname . ". Je moet [left] meer [piece] te voltooien het artefact.";
				$this->singular = "stuk";
				$this->plural = "stuks";
				$this->upgrade = "Upgrade Cloak";
			break;

			case "finnish":
				$this->classname = "Sol Recovery Teos";
				$this->description = "Tämä Teos luo Madonreikä mistä tahansa alalla (realspace tai SG) on Sol ja liikenne siellä hetkessä. Kun pisteet saavuttaa " . $this->scoremax_text . " et voi nähdä tai pickup tämän artefakti. Jos olet, joilla on yksi menetät sen. On yhteensä " . $this->pieces . " kappaletta, jotka on löydettävä. Kun kaikki palaset löytyy voit luoda Madonreikä kautta Artifact List-komentoa. Teos kappaleet on tallennettu aluksella. Jos alus on tuhoutunut hyökkääjä voi löytää joitakin paloja. Kaikki palaset eivät vangiksi hyökkääjän on satunnaisesti ympäri galaksia.";
				$this->success = "Olet löytänyt kaikki " . $this->pieces . " palaset " . $this->classname . ". Voit käyttää tätä artefakti milloin tahansa Artifact-sivulta.";
				$this->incomplete = "Olet löytänyt [pieces] paloja " . $this->classname . ". Tarvitset [left] lisää [piece] loppuun artefakti.";
				$this->singular = "palan";
				$this->plural = "palaset";
				$this->upgrade = "Upgrade Viitta";
			break;

			case "indonesian":
				$this->classname = "Sol Pemulihan artifak";
				$this->description = "Artefak ini akan menciptakan sebuah lubang cacing dari sektor apapun (realspace atau SG) untuk Sol dan transportasi Anda ke sana langsung. Setelah Anda mencapai skor " . $this->scoremax_text . " Anda tidak akan dapat melihat atau pickup artifak ini. Jika Anda membawa salah satu Anda akan kehilangan itu. Ada total " . $this->pieces . " potongan-potongan yang perlu ditemukan. Setelah semua potongan yang ditemukan Anda dapat menciptakan lubang cacing melalui perintah Daftar artefak. Potongan artefak akan disimpan di kapal Anda. Jika Anda adalah menghancurkan kapal penyerang dapat menemukan beberapa bagian. Setiap potongan tidak tertangkap oleh penyerang akan didistribusikan secara acak di sekitar galaksi.";
				$this->success = "Anda telah menemukan semua " . $this->pieces . " potongan " . $this->classname . ". Anda dapat menggunakan artifak ini sewaktu-waktu dari halaman Daftar artefak.";
				$this->incomplete = "Anda telah menemukan [pieces] potongan " . $this->classname . ". Anda perlu [left] lebih [piece] untuk melengkapi artefak.";
				$this->singular = "potong";
				$this->plural = "potongan";
				$this->upgrade = "Upgrade Jubah";
			break;

			case "norwegian":
				$this->classname = "Sol Recovery Artifact";
				$this->description = "Dette Artifact vil lage et ormehull fra hvilken som helst sektor (realspace eller SG) til Sol og transportere deg dit umiddelbart. Når score når " . $this->scoremax_text . " vil du ikke kunne se eller pickup denne gjenstand. Hvis du er bærer den du vil miste den. Det er totalt " . $this->pieces . " stykker som trenger å bli funnet. Når alle brikkene er funnet kan du lage ormehull gjennom Artifact Liste-kommandoen. The Artifact brikkene vil bli lagret på skipet ditt. Hvis skipet ditt blir ødelagt angriperen kan finne noen av bitene. Eventuelle brikkene ikke fanges opp av angriperen vil bli tilfeldig fordelt rundt om i galaksen.";
				$this->success = "Du har funnet alle " . $this->pieces . " stykker av " . $this->classname . ". Du kan bruke denne gjenstand når som helst fra Artifact-siden.";
				$this->incomplete = "Du har funnet [pieces] stykker av " . $this->classname . ". Du trenger [left] mer [piece] for å fullføre gjenstand.";
				$this->singular = "piece";
				$this->plural = "pieces";
				$this->upgrade = "Oppgrader Cloak";
			break;

			case "portuguese":
				$this->classname = "Sol Recuperação Artefato";
				$this->description = "Este artefato criará um Wormhole de qualquer setor (Realspace ou SG) ao Sol e transporte até lá imediatamente. Uma vez que sua pontuação atinge " . $this->scoremax_text . " você não será capaz de ver ou pickup este artefato. Se você estiver carregando um que você vai perdê-la. Há um total de " . $this->pieces . " peças que precisam ser encontrados. Uma vez que todas as peças são encontradas você pode criar o Wormhole através do comando List Artefato. As peças Artefato serão armazenados em seu navio. Se o seu navio é destruído o invasor pode encontrar algumas das peças. Todas as partes não captadas pelo atacante serão distribuídos aleatoriamente em torno da galáxia.";
				$this->success = "Você encontrou todos " . $this->pieces . " peças do " . $this->classname . ". Você pode usar esse artefato, a qualquer momento a partir da página Lista de Artefato.";
				$this->incomplete = "Você encontrou [pieces] peças do " . $this->classname . ". Você precisa [left] mais [piece] para completar o artefato.";
				$this->singular = "pedaço";
				$this->plural = "peças";
				$this->upgrade = "Upgrade Cloak";
			break;

			case "swedish":
				$this->classname = "Sol Recovery Artefakt";
				$this->description = "Detta Artefakt skapar ett maskhål från någon sektor (realspace eller SG) till Sol och transportera dig dit direkt. När din poäng når " . $this->scoremax_text . " Du kommer inte att kunna se eller pickup denna artefakt. Om du bär en du kommer att förlora det. Finns totalt " . $this->pieces . " bitar som måste hittas. När alla bitar finns du kan skapa Wormhole genom den fiktiva List kommandot. Artefakten bitar sparas på ditt skepp. Om ditt skepp förstörs Angriparen kan hitta några av de bitar. Alla bitar som inte fångas upp av angriparen kommer att vara slumpmässigt fördelade över galaxen.";
				$this->success = "Du har hittat alla " . $this->pieces . " bitar av " . $this->classname . ". Du kan använda denna artefakt som helst från den fiktiva List sida.";
				$this->incomplete = "Du har hittat [pieces] bitar av " . $this->classname . ". Du behöver [left] mer [piece] för att genomföra artefakt.";
				$this->singular = "piece";
				$this->plural = "bitar";
				$this->upgrade = "Upgrade Cloak";
			break;

			default:
				$this->classname = "Sol Recovery Artifact";
				$this->description = "This Artifact will create a Wormhole from any sector (realspace or SG) to Sol and transport you there instantly.  Once your score reaches " . $this->scoremax_text . " you will not be able to see or pickup this artifact.  If you are carrying one you will lose it.  There are a total of " . $this->pieces . " pieces that need to be found.  Once all pieces are found you can create the Wormhole through the Artifact List command.  The Artifact pieces will be stored on your ship.  If your ship is destroyed the attacker may find some of the pieces.  Any pieces not captured by the attacker will be randomly distributed around the galaxy.";
				$this->success = "You have found all " . $this->pieces . " pieces of the " . $this->classname . ".  You can use this artifact at any time from the Artifact List page.";
				$this->incomplete = "You have found [pieces] pieces of the " . $this->classname . ".  You need [left] more [piece] to complete the artifact.";
				$this->singular = "piece";
				$this->plural = "pieces";
				$this->upgrade = "Upgrade Cloak";
			break;
		}
	}

	function sched_process_artifact($artifact_type)
	{
		global $db, $db_prefix, $adminexecuted;

		include ("globals/artifacts_sched.inc");

		if($adminexecuted == 1)
		{
			TextFlush ( "<b>" . ucwords($artifact_type) . " Artifact Added</b><br>");
		}

		$result2 = $db->Execute("SELECT count(sector_id) as total FROM {$db_prefix}universe WHERE sg_sector=0");
   		db_op_result($result2,__LINE__,__FILE__);
		$ratio = $result2->fields['total'] / 5000;

		$res = $db->Execute("SELECT count(artifact_id) total FROM {$db_prefix}artifacts WHERE artifact_type='" . $this->class . "'");
   		db_op_result($res,__LINE__,__FILE__);

 		$totalpieces = ($this->pieces * floor($this->maximum_in_galaxy * $ratio)) - $res->fields['total'];
		for ($i = 1; $i <= $totalpieces; $i++)
		{
			artifacts_sched($artifact_type, $this->min_cloak, $this->max_cloak, $this->scoremax, $i);
		}
	}

	function found_artifact_piece($artifact_id)
	{
		global $db, $db_prefix, $playerinfo;

		include ("globals/insert_news.inc");

		$res = $db->Execute("SELECT count(artifact_id) total FROM {$db_prefix}artifacts WHERE player_id=$playerinfo[player_id] and artifact_type='" . $this->class . "'");
   		db_op_result($res,__LINE__,__FILE__);
   		if($res->fields['total'] < $this->pieces)
   		{
			$updateit = $db->Execute("UPDATE {$db_prefix}artifacts SET on_port=0, on_planet_id=0, sector_id=0, player_id = $playerinfo[player_id] WHERE artifact_id=$artifact_id");
    		db_op_result($updateit,__LINE__,__FILE__);
    		$res->fields['total']++;
    	}

   		if($res->fields['total'] == $this->pieces)
   		{
 			insert_news($this->classname . "|" . $playerinfo['character_name'], 1, "artifact");

   			return $this->success;
   		}
   		else
   		{
   			$incomplete = str_replace("[pieces]", $res->fields['total'], $this->incomplete);
   			$left = $this->pieces - $res->fields['total'];
   			$incomplete = str_replace("[left]", $left, $incomplete);
  			if($left == 1)
   			{
   				$incomplete = str_replace("[piece]", $this->singular, $incomplete);
   				$pieces = $this->singular;
  			}
   			else
   			{
   				$incomplete = str_replace("[piece]", $this->plural, $incomplete);
    			$pieces = $this->plural;
   			}
			insert_news($this->classname . "|" . $playerinfo['character_name'] . "|$left|$pieces", 1, "artifactfound");
   			return $incomplete;
   		}
	}

	function preprocess_artifact($artifact_type)
	{
		global $db, $db_prefix, $playerinfo, $shipinfo;

		$res = $db->Execute("SELECT count(artifact_id) total FROM {$db_prefix}artifacts WHERE player_id=$playerinfo[player_id] and artifact_type='" . $this->class . "'");
   		db_op_result($res,__LINE__,__FILE__);
   		if($res->fields['total'] < $this->pieces)
   		{
   			return;
	  	}

		$debug_query = $db->Execute("UPDATE {$db_prefix}ships SET sector_id=1 WHERE ship_id=$shipinfo[ship_id]");
		db_op_result($debug_query,__LINE__,__FILE__);

		$res = $db->Execute("DELETE FROM {$db_prefix}artifacts WHERE player_id=$playerinfo[player_id] and artifact_type='" . $this->class . "'");
		db_op_result($res,__LINE__,__FILE__);

		$output ="<META HTTP-EQUIV=\"Refresh\" CONTENT=\"0;URL=main.php\">";
		return $output;

	}

	function postprocess_artifact($artifact_type)
	{
		global $db, $db_prefix, $playerinfo, $l_global_mmenu;

	}
}

?>